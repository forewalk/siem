당신은 사용자가 작성한 기획서를 검토하는 AI 검토자 역할입니다.

사용자가 `/review-spec {feature_name}` 명령을 실행했습니다.

다음 작업을 수행하세요:

1. **기획서 파일 읽기**
   - `docs/workflows/{feature_name}/1_{feature_name}_spec.md` 파일을 읽습니다
   - 파일이 없으면 사용자에게 오류 메시지를 제공하세요

2. **기획서 분석 및 검토**
   다음 관점에서 기획서를 상세히 검토하세요:

   **A. 요구사항 완전성**
   - 기능 요구사항이 명확하고 구체적인가?
   - 비기능 요구사항(성능, 보안, 확장성)이 정의되었는가?
   - 누락된 요구사항은 없는가?

   **B. 기술적 실현 가능성**
   - 현재 시스템 아키텍처(FastAPI + PostgreSQL)에서 구현 가능한가?
   - 기존 레이어 구조(Repository → Service → Endpoint)와 호환되는가?
   - 필요한 외부 의존성이 있는가?

   **C. 데이터베이스 설계 초안**
   - 필요한 테이블 구조 제안
   - 컬럼 타입 및 제약조건 제안
   - 인덱스 전략 제안
   - CLAUDE.md의 데이터베이스 네이밍 컨벤션 준수 확인

   **D. 사용자 시나리오 검증**
   - 제시된 시나리오가 충분한가?
   - 예외 상황이 고려되었는가?
   - 엣지 케이스가 누락되지 않았는가?

   **E. 보안 및 성능**
   - 보안 취약점이 있는가?
   - 성능 병목 지점은 없는가?
   - 인증/인가 요구사항이 명확한가?

   **F. 명확화 필요 사항**
   - 모호한 부분 식별
   - 의사결정이 필요한 사항 (옵션 제시)
   - 추가 정보가 필요한 부분

3. **검토 문서 생성**
   - `.claude/templates/2_spec_review_template.md` 템플릿을 읽습니다
   - 템플릿의 모든 섹션을 채워 검토 문서를 작성합니다
   - 다음 플레이스홀더를 치환:
     - `{FEATURE}` → 기능 이름
     - `{DATE}` → 오늘 날짜
     - `{feature}` → feature_name (kebab-case)
   - **중요: 검토 문서 끝에 반드시 다음 섹션들을 추가하세요:**
     - "10. 검토 질문에 대한 답변" 섹션 (사용자가 답변을 작성할 템플릿)
     - "추가 결정 사항" 섹션 (이미지 필수 여부, 권한 등)
     - "11. 답변 기반 업데이트 사항" 섹션 (API/데이터 모델 확정 내용)
     - 각 질문마다 답변란과 이유 작성란 제공
   - `docs/workflows/{feature_name}/2_{feature_name}_spec_reviewed.md`에 저장
   - **파일 생성 시 한글이 포함되므로 반드시 Bash의 cat heredoc 방식 사용** (CLAUDE.md 참조)

4. **검토 결과 요약**
   사용자에게 다음을 포함한 요약을 제공:
   - 전체 평가 (1-3줄)
   - 주요 개선 사항 (3-5개)
   - 명확화가 필요한 질문 (3-5개)
   - 다음 단계 안내

5. **사용자 안내**
   ```
   기획서 검토가 완료되었습니다! ✅

   📄 검토 문서: docs/workflows/{feature_name}/2_{feature_name}_spec_reviewed.md

   📊 검토 결과 요약:
   [요약 내용]

   ❓ 명확화 필요 사항:
   1. [질문 1]
   2. [질문 2]
   ...

   다음 단계:
   1. 2번 파일을 열어 "10. 검토 질문에 대한 답변" 섹션으로 이동하세요
   2. 각 질문에 대한 답변을 작성하세요 (선택한 옵션 + 이유)
   3. "11. 답변 기반 업데이트 사항"에 확정된 내용을 정리하세요
   4. 답변 완료 후 `/finalize-spec {feature_name}` 명령을 실행하세요
      → 1번(원본) + 2번(검토+답변)을 합쳐 3번(최종 기획서) 생성

   💡 팁: 1번 원본 기획서는 보존되므로, 2번 문서에서 의사결정 과정을 자유롭게 기록하세요!
   ```

**중요:**
- CLAUDE.md의 프로젝트 규칙을 반드시 참고하세요
- 건설적이고 구체적인 피드백을 제공하세요
- 기술적 타당성을 정확히 평가하세요
- 보안과 성능 측면을 반드시 고려하세요
- 데이터베이스 네이밍 컨벤션(snake_case, plural 등)을 확인하세요

**한글 문서 작성 시 주의:**
- 마크다운 문서 생성 시 반드시 Bash의 `cat << 'EOF' > 파일경로` heredoc 방식을 사용하세요
- Write 도구 대신 Bash heredoc을 사용해야 한글이 깨지지 않습니다
- 예시:
```bash
cat << 'EOF' > docs/workflows/{feature_name}/2_{feature_name}_spec_reviewed.md
# 검토 문서
한글 내용...
EOF
```
